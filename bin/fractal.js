!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("GREN")):"function"==typeof define&&define.amd?define("FRACTAL",["GREN"],e):"object"==typeof exports?exports.FRACTAL=e(require("GREN")):t.FRACTAL=e(t.GREN)}(this,function(t){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(1);Object.keys(i).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}})})},function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function l(t,e,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var n=Object.getPrototypeOf(t);return null===n?void 0:l(n,e,r)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(r)},c=r(2),h=(e.KochCurve=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?300:arguments[0],r=arguments.length<=1||void 0===arguments[1]?100:arguments[1];i(this,e);var o=n(this,Object.getPrototypeOf(e).call(this));return o.renderer=new c.WebGLRenderer,o.renderer.setStyle(t,r,"margin:0px; position:absolute; z-index:1;"),o.gl=o.renderer.gl,o.domElement=o.renderer.canvas,o.renderer.isWebGLSuported===!1?n(o):(o.pMatrix=c.Matrix4.orthogonal(0,o.renderer.canvasWidth,0,o.renderer.canvasHeight,-5e3,5e3),o._initProgram(),o._initKochLines(),o.startAnimating(),o)}return o(e,t),a(e,[{key:"_initProgram",value:function(){this.prg=this.gl.makeProgram(c.commonVS,c.commonFS),this.prg&&(this.prg.setAttribLocations(["vertexPosition"]),this.prg.setUniformLocations(["pMatrix","mvMatrix","color"]),this.gl.uniformMatrix4fv(this.prg.pMatrix,!1,this.pMatrix),this.gl.uniform4fv(this.prg.color,[1,1,1,1]))}},{key:"_initKochLines",value:function(){this.maxIterations=5,this.curIterations=0,this.maxInterpolation=35,this.curInterpolation=0;var t=30*window.devicePixelRatio,e=this.renderer.canvasWidth-2*t,r=Math.sin(60/180*Math.PI)*e,i=Math.sin(60/180*Math.PI)*(e/3),n=new c.Vector2(this.renderer.centerX,this.renderer.centerY+(r+i)/2),o=n.y-r;this.lines=[];var a=this.renderer.centerX-t,s=new c.Vector2(-a,0),l=new c.Vector2(a,0),u=new h(s,l);this.lines.push(u),this.mvMatList=[];var p=new c.Matrix4;c.Matrix4.translate(p,[this.renderer.centerX,o,0]),c.Matrix4.rotate(p,p,Math.PI,[0,0,1]),this.mvMatList.push(p);var f=new c.Vector2(t,o),d=new c.Vector2(this.renderer.canvasWidth-t,o),v=c.Vector2.sub(f,n).scale(.5).add(f),x=c.Vector2.sub(d,n).scale(.5).add(d),g=new c.Matrix4;c.Matrix4.translate(g,[v.x,v.y,0]),c.Matrix4.rotate(g,g,60/180*Math.PI,[0,0,1]),this.mvMatList.push(g);var y=new c.Matrix4;c.Matrix4.translate(y,[x.x,x.y,0]),c.Matrix4.rotate(y,y,-60/180*Math.PI,[0,0,1]),this.mvMatList.push(y)}},{key:"updateFrameData",value:function(){var t=this.lines[0],e=t.start;this.vertices=[e.x,e.y,0],this.indices=[0];var r=1;this.curInterpolation===this.maxInterpolation&&(this.curInterpolation=0,this.maxInterpolation=Math.ceil(.7*this.maxInterpolation),this.curIterations+=1),this.curInterpolation+=1;var i=!1,n=[];this.curInterpolation===this.maxInterpolation&&(i=!0);for(var o=0;o<this.lines.length;o++){var a=this.lines[o],s=a.generatePointB(this.curInterpolation/this.maxInterpolation);this.vertices=this.vertices.concat([a.pointA.x,a.pointA.y,0,s.x,s.y,0,a.pointC.x,a.pointC.y,0,a.end.x,a.end.y,0]),this.indices=this.indices.concat([r,r+1,r+2,r+3]),i&&(n.push(new h(a.start,a.pointA)),n.push(new h(a.pointA,s)),n.push(new h(s,a.pointC)),n.push(new h(a.pointC,a.end))),r+=4}i&&(this.lines=n);var c=this.gl.createArrayBufferWithTypedArray(new Float32Array(this.vertices));this.gl.enableVertexAttribArray(this.prg.vertexPosition),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c),this.gl.vertexAttribPointer(this.prg.vertexPosition,3,this.gl.FLOAT,!1,0,0),this.indexBuffer=this.gl.createElementBufferWithTypedArray(new Uint16Array(this.indices)),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.curIterations===this.maxIterations&&this.curInterpolation===this.maxInterpolation&&this._initKochLines()}},{key:"enterFrame",value:function(){var t=this;s(Object.getPrototypeOf(e.prototype),"enterFrame",this).call(this),this.updateFrameData(),this.gl.clearColor(0,0,0,0),this.gl.viewport(0,0,this.renderer.canvasWidth,this.renderer.canvasHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.lineWidth(2),this.mvMatList.forEach(function(e){t.gl.uniformMatrix4fv(t.prg.mvMatrix,!1,e),t.gl.drawElements(t.gl.LINE_STRIP,t.indices.length,t.gl.UNSIGNED_SHORT,0)})}}]),e}(c.IAnimation),function(){function t(e,r){i(this,t),this.start=e,this.end=r,this.vector=new c.Vector2(this.end.x-this.start.x,this.end.y-this.start.y),this.center=c.Vector2.copy(this.vector).scale(.5).add(this.start);var n=c.Vector2.copy(this.vector).scale(1/3),o=c.Vector2.copy(this.vector).scale(2/3),a=new c.Matrix4;c.Matrix4.rotate(a,a,60/180*Math.PI,[0,0,1]);var s=c.Vector2.sub(n,o).applyMatrix4(a);this.pointA=n.add(this.start);var h=s.add(this.pointA);this.pointC=o.add(this.start),this.animationVector=c.Vector2.sub(this.center,h)}return a(t,[{key:"generatePointB",value:function(t){return c.Vector2.copy(this.animationVector).scale(t).add(this.center)}}]),t}())},function(e,r){e.exports=t}])});