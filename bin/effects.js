!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("GREN")):"function"==typeof define&&define.amd?define("EFFECT",["GREN"],e):"object"==typeof exports?exports.EFFECT=e(require("GREN")):t.EFFECT=e(t.GREN)}(this,function(t){return function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1);Object.keys(r).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})})},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.PSSoundWave=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=function l(t,e,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var n=Object.getPrototypeOf(t);return null===n?void 0:l(n,e,i)}if("value"in r)return r.value;var s=r.get;if(void 0!==s)return s.call(i)},h=i(2),c=i(3);e.PSSoundWave=function(t){function e(){var t=arguments.length<=0||void 0===arguments[0]?300:arguments[0],i=arguments.length<=1||void 0===arguments[1]?100:arguments[1];r(this,e);var s=n(this,Object.getPrototypeOf(e).call(this));s.renderer=new c.WebGLRenderer,s.renderer.setStyle(t,i,"margin:0px; position:absolute; z-index:1;"),s.gl=s.renderer.gl,s.domElement=s.renderer.canvas,s.colors=[[1,1,1,1],[1,1,1,.4],[1,1,1,.3],[1,1,1,.2],[1,1,1,.1]],s.mvMatrixList=[];var a=s.renderer.canvasHeight/2,o=c.Matrix4.identity();c.Matrix4.translate(o,[0,a,0]),s.mvMatrixList.push(o);var l=c.Matrix4.identity();c.Matrix4.translate(l,[0,a,0]),c.Matrix4.scale(l,[1,.9,1]),s.mvMatrixList.push(l);var u=c.Matrix4.identity();c.Matrix4.translate(u,[0,a,0]),c.Matrix4.scale(u,[1,.7,1]),s.mvMatrixList.push(u);var d=c.Matrix4.identity();c.Matrix4.translate(d,[0,a,0]),c.Matrix4.scale(d,[1,.3,1]),s.mvMatrixList.push(d);var v=c.Matrix4.identity();return c.Matrix4.translate(v,[0,a,0]),c.Matrix4.scale(v,[1,.5,1]),c.Matrix4.rotate(v,v,Math.PI,[0,0,1]),s.mvMatrixList.push(v),s.pMatrix=c.Matrix4.orthogonal(0,s.renderer.canvasWidth,0,s.renderer.canvasHeight,-5e3,5e3),s._initProgram(),s.wave=new h.Wave(s.gl,s.prg,s.renderer.canvasWidth,0),s.startAnimating(),s}return s(e,t),a(e,[{key:"_interactVertice",value:function(){this.vertices=[];for(var t=void 0,e=void 0,i=void 0,r=void 0,n=0;n<this.amplitudes.length;n++){var s=this.amplitudes[n],a=4*n;t=this.vertexVectors[a],e=this.vertexVectors[a+1],i=this.vertexVectors[a+2],r=this.vertexVectors[a+3],this.vertices=this.vertices.concat([t.x,t.y+s,e.x,e.y+s,r.x,r.y+s,i.x,r.y+s])}}},{key:"_initProgram",value:function(){this.prg=this.gl.makeProgram(c.commonVS,c.commonFS),this.prg&&(this.prg.setAttribLocations(["vertexPosition"]),this.prg.setUniformLocations(["pMatrix","mvMatrix","color"]),this.gl.uniformMatrix4fv(this.prg.pMatrix,!1,this.pMatrix))}},{key:"enterFrame",value:function(){o(Object.getPrototypeOf(e.prototype),"enterFrame",this).call(this),this.gl.clearColor(0,0,0,0),this.gl.viewport(0,0,this.renderer.canvasWidth,this.renderer.canvasHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.wave.generateWave(),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);for(var t=this.mvMatrixList.length-1;t>=0;t--)this.gl.uniform4fv(this.prg.color,this.colors[t]),this.gl.uniformMatrix4fv(this.prg.mvMatrix,!1,this.mvMatrixList[t]),this.wave.draw()}}]),e}(c.IAnimation)},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=i(3);e.Wave=function(){function t(e,i,n,s){r(this,t),this.gl=e,this.prg=i,this.positionY=s,this.drawWidth=n,this.padding=10,this.vertexVectors=[],this.vertices=[],this.indices=[],this.amplitudes=[],this.waveLengthArr=[],this.startAngle=0,this._initData()}return n(t,[{key:"_initData",value:function(){this._generateVerticesData(),this.createIndexBuffer()}},{key:"createIndexBuffer",value:function(){this.indexBuffer=this.gl.createElementBufferWithData(this.indices)}},{key:"_generateVerticesData",value:function(){for(var t=2,e=0,i=60,r=5,n=0,a=new s.GLBezier,o=Math.sqrt(i*i+r*r),h=a.generateCoords([[0,0],[i,0],[i,r]],o,1),c=[],l=0;l<h.length;l++)c.push(h[l].coords[1]);for(var u=this.positionY,d=1.5*window.devicePixelRatio,v=0,f=this.drawWidth/2,p=Math.floor(this.drawWidth/2),g=this.drawWidth/6,x=(p-g)/f,y=35*window.devicePixelRatio,m=this.drawWidth/t,w=Math.PI/(m-this.padding-i),M=0;M<=this.drawWidth;M+=t){var b=new s.Vector2(M-d,u-d),E=new s.Vector2(M-d,u+d),P=new s.Vector2(M+d,u-d),_=new s.Vector2(M+d,u+d);this.vertexVectors=this.vertexVectors.concat([b,E,_,P]),this.indices=this.indices.concat([v,v+1,v+2,v,v+2,v+3]),v+=4;var A=2*this.padding;if(M>=this.padding&&M<=this.drawWidth-this.padding){M<this.padding+i?(n+=2,this.amplitudes.push(c[n-1])):M>this.drawWidth-this.padding-i?(this.amplitudes.push(c[n-1]),n-=2):(e+=w,this.amplitudes.push(r+Math.sin(e)*y));var O=f>M?M:this.drawWidth-M;A=g+x*O}else this.amplitudes.push(0);this.waveLengthArr.push(A)}}},{key:"generateWave",value:function(){this.vertices=[];var t=void 0,e=void 0,i=void 0,r=void 0,n=this.startAngle,s=Math.PI/200;this.startAngle+=8*s;for(var a=0;a<this.amplitudes.length;a++){var o=4*a;t=this.vertexVectors[o],e=this.vertexVectors[o+1],i=this.vertexVectors[o+2],r=this.vertexVectors[o+3];var h=Math.sin(n)*this.amplitudes[a];n-=2*Math.PI/this.waveLengthArr[a],this.vertices=this.vertices.concat([t.x,t.y+h,e.x,e.y+h,r.x,r.y+h,i.x,r.y+h])}}},{key:"draw",value:function(){this.vertexBuffer=this.gl.createArrayBufferWithData(this.vertices),this.gl.enableVertexAttribArray(this.prg.vertexPosition),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.vertexAttribPointer(this.prg.vertexPosition,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}},{key:"clone",value:function(){var e=new t(this.gl,this.prg,this.drawWidth,this.positionY-20);return e.vertexVectors=this.vertexVectors.concat(),e.amplitudes=this.amplitudes.concat(),e.waveLengthArr=this.waveLengthArr.concat(),e.createIndexBuffer(),e}}]),t}()},function(e,i){e.exports=t}])});