!function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var r=i(1);window.SurfaceChart=r.SurfaceChart},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.SurfaceChart=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=i(2),s=i(4),o=i(5),h=i(6),l=i(7),u=i(9);e.SurfaceChart=function(){function t(e,i){if(r(this,t),this.paddingLR=50,this.paddingTop=50,this.paddingBottom=50,i.width<300||i.height<200)throw new Error("SurfaceChart 绘制区域的宽不能小于 300, 高不能小于 200");if(!e||0===e.length)throw new Error("SurfaceChart 需要有效数组做为初始化参数");this.renderer=new l.WebGLRenderer,this.renderer.setStyle(i.width,i.height,"margin:0px; position:absolute; z-index:10"),this.gl=this.renderer.gl,this.width=this.renderer.canvasWidth,this.height=this.renderer.canvasHeight,this.domElement=new o.SCDomElement(i).panel,this.domElement.appendChild(this.renderer.canvas),this.dataSource=new a.SCDataSource(e,this.width-2*this.paddingLR,this.height-this.paddingBottom-this.paddingTop),this.mvMatrix=u.Matrix4.identity(),u.Matrix4.scale(this.mvMatrix,[.6,.6,.7]),u.Matrix4.rotate(this.mvMatrix,this.mvMatrix,.3,[1,0,0]),u.Matrix4.rotate(this.mvMatrix,this.mvMatrix,.75,[0,1,0]),this.pMatrix=u.Matrix4.orthogonal(-this.renderer.centerX,this.renderer.centerX,-this.renderer.centerY,this.renderer.centerY,-5e3,5e3),this.initProgram(),this.surface=new s.SCSurface(this.renderer.gl,this.prg,this.dataSource),this.draw()}return n(t,[{key:"initProgram",value:function(){this.prg=this.gl.makeProgram(h.pixelVS,h.pixelFS),null===this.prg?console.log("着色器加载失败"):(this.prg.setAttribLocations(["vertexPosition","vertexColor"]),this.prg.setUniformLocations(["pMatrix","mvMatrix"]),this.gl.uniformMatrix4fv(this.prg.mvMatrix,!1,this.mvMatrix),this.gl.uniformMatrix4fv(this.prg.pMatrix,!1,this.pMatrix))}},{key:"draw",value:function(){this.gl.clearColor(0,0,0,0),this.gl.disable(this.gl.DEPTH_TEST),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.viewport(0,0,this.renderer.canvasWidth,this.renderer.canvasHeight),this.surface.draw()}}]),t}()},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.SCDataSource=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),a=i(3);e.SCDataSource=function(){function t(e,i,n){r(this,t);var a=[2186385,7384904,3631549,16696630,10855845,15890740,6988761];this.colorGroup=this._colors(a),this.drawWidth=i,this.drawHeight=n,this.rowCount=e.length,this._validateRowAndCol(this.rowCount),this.colCount=e[0].length,this._validateRowAndCol(this.colCount),this.referenceLineCount=6,this.scaleLabels=[],this.dataScale=0,this.minValue=this.maxValue=parseFloat(e[0][0]),this._validateDataType(this.minValue),this._formatData(e)}return n(t,[{key:"_colors",value:function(t){for(var e=[],i=0;i<t.length;i++)e.push(a.Color.hex2rgb(t[i]));return e}},{key:"_validateRowAndCol",value:function(t){if(2>t)throw new Error("SurfaceChart 至少需要两行两列数据 ")}},{key:"_validateDataType",value:function(t){if(void 0===t)throw new Error("SurfaceChart 需要的数据项必须是整数或浮点数")}},{key:"_formatData",value:function(t){this.dataSource=[];for(var e=0;e<this.rowCount;e++){for(var i=t[e],r=[],n=0;n<this.colCount;n++){var a=parseFloat(i[n]);this._validateDataType(a),a<this.minValue?this.minValue=a:a>this.maxValue&&(this.maxValue=a),r.push(a)}this.dataSource.push(r)}this._calculateScaleLabel(),this._generateVertices()}},{key:"_generateVertices",value:function(){this.vertices=[],this.colors=[];for(var t=this.drawWidth/(this.colCount-1),e=t*this.rowCount/2+t,i=0;i<this.rowCount;i++){e-=t;for(var r=-(this.drawWidth/2)-t,n=this.dataSource[i],a=0;a<this.colCount;a++){r+=t;var s=n[a];this.vertices.push(r,(s-this.surfaceOffsetY)*this.dataScale,e);var o=this._calculateVertexColor(s);this.colors.push(o[0],o[1],o[2])}}this._generateIndices(),console.log(this.minValue,this.maxValue),console.log(this.scaleLabels)}},{key:"_calculateVertexColor",value:function(t){for(var e=this.scaleLabels[0],i=1;i<this.scaleLabels.length;i++){var r=this.scaleLabels[i];if(e>=t&&t>=r)return this.colorGroup[i-1];e=r}}},{key:"_generateIndices",value:function(){this.indices=[];for(var t=1;t<this.rowCount;t++)for(var e=t*this.colCount,i=1;i<this.colCount;i++){var r=e+i,n=r-1,a=r-this.colCount,s=a-1;this.indices.push(s,a,n,a,n,r)}}},{key:"_calculateScaleLabel",value:function(){var t=Math.abs(this.maxValue-this.minValue);this.surfaceOffsetY=this.minValue+t/2;var e=t/(this.referenceLineCount-1).toFixed(2);e=this._calculateGap(e,1);var i=0;if(this.maxValue>0&&this.minValue<0){for(;i<this.maxValue;)i+=e,this.scaleLabels.unshift(i);i=0}else i=this.maxValue;for(this.scaleLabels.push(i);i>this.minValue;)i-=e,this.scaleLabels.push(i);this.dataScale=this.drawHeight/Math.abs(this.scaleLabels[0]-this.scaleLabels[this.scaleLabels.length-1])}},{key:"_calculateGap",value:function(t,e){if(e>t)return t;e*=10;var i=(t/e).toFixed(1)*e;return this._calculateGap(i,e)}}]),t}()},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();e.Color=function(){function t(){i(this,t)}return r(t,null,[{key:"hex2rgb",value:function(t){"string"==typeof t&&"#"===t.substr(0,1)&&(t="0x"+t.substr(1,t.length-1));var e=[];return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}}]),t}()},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();e.SCSurface=function(){function t(e,r,n){i(this,t),this.gl=e,this.prg=r,this.dataSource=n,this.vertices=n.vertices,this.colorList=n.colors,this.indices=n.indices,this.vetexBuffer=e.createArrayBufferWithData(this.vertices),this.indexBuffer=e.createElementBufferWithData(this.indices),this.colorBuffer=e.createArrayBufferWithData(this.colorList),this.updateBufferData()}return r(t,[{key:"updateBufferData",value:function(){}},{key:"draw",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vetexBuffer),this.gl.vertexAttribPointer(this.prg.vertexPosition,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.prg.vertexPosition),this.gl.enableVertexAttribArray(this.prg.vertexColor),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorBuffer),this.gl.vertexAttribPointer(this.prg.vertexColor,3,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}}]),t}()},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.SCDomElement=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();i(3),e.SCDomElement=function(){function t(e){r(this,t),this.width=e.width,this.height=e.height,this.title=e.title,this.fontColor=e.fontColor?e.fontColor:16448250,this.backgroundColor=e.backgroundColor?e.backgroundColor:3487029,this.panel=this.createPanel(),this.title&&this.createTitle()}return n(t,[{key:"createPanel",value:function(){var t="position:relative;display:block; padding:0px; margin: 0px;  -webkit-tap-highlight-color:rgba(0, 0, 0, 0); -webkit-user-select: none; user-select: none; width:"+this.width+"px; height:"+this.height+"px; color: "+this.fontColor+"; background-color:"+this.backgroundColor;return this.createElement("div",t)}},{key:"createTitle",value:function(){var t="position:absolute; left:0px; top: 5px; font-size: 20px; font-style:bold;  width:"+this.width+"px; height:30px; text-align: center; z-index: 0",e=this.createElement("h3",t);e.innerHTML=this.title,this.panel.appendChild(e)}},{key:"createElement",value:function(t,e){var i=document.createElement(t);return i.setAttribute("style",e),i}}]),t}()},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.pixelVS="\nattribute vec3 vertexPosition;\nattribute vec3 vertexColor;\n\nuniform mat4 mvMatrix;\nuniform mat4 pMatrix;\n\nvarying vec3 color;\n\nvoid main(void) {\n  color = vertexColor;\n  gl_Position = pMatrix * mvMatrix * vec4(vertexPosition, 1.0);\n}\n",e.pixelFS="\nprecision mediump float;\n\nvarying vec3 color;\n\nvoid main(void) {\n  gl_FragColor = vec4(color, 0.6);\n  // gl_FragColor = vec4(1.0, 0.0, 0.0, 0.6);\n}\n"},function(t,e,i){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLRenderer=void 0;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=i(8),o=r(s);e.WebGLRenderer=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],i=arguments.length<=1||void 0===arguments[1]?400:arguments[1],r=arguments.length<=2||void 0===arguments[2]?400:arguments[2];n(this,t),this.canvasWidth=0,this.canvasHeight=0,this.canvas=null,null!==e&&(this.canvas=document.getElementById(e)),null===this.canvas&&(this.canvas=document.createElement("canvas"),document.body.appendChild(this.canvas)),this.gl=this.getGLContext(),null===this.gl?this.isWebGLSuported=!1:(this.isWebGLSuported=!0,this.gl.createArrayBufferWithData=o.createArrayBufferWithData,this.gl.createElementBufferWithData=o.createElementBufferWithData,this.gl.createTextureWithData=o.createTextureWithData,this.gl.makeProgram=o.makeProgram),this.setStyle(i,r)}return a(t,[{key:"setStyle",value:function(){var t=arguments.length<=0||void 0===arguments[0]?400:arguments[0],e=arguments.length<=1||void 0===arguments[1]?400:arguments[1],i=arguments.length<=2||void 0===arguments[2]?null:arguments[2];null!=this.canvas&&(this.canvasWidth=t*window.devicePixelRatio,this.canvasHeight=e*window.devicePixelRatio,this.canvas.width=this.canvasWidth,this.canvas.height=this.canvasHeight,null===i?(this.canvas.style.width=t+"px",this.canvas.style.height=e+"px"):this.canvas.setAttribute("style","width:"+t+"px; height: "+e+"px; "+i+";"),this.canvas.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)",this.centerX=this.canvasWidth/2,this.centerY=this.canvasHeight/2)}},{key:"getGLContext",value:function(){for(var t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=null,i=0;i<t.length&&!(e=this.canvas.getContext(t[i]));++i);return e}}]),t}()},function(t,e){"use strict";function i(t,e){function i(t,e){var i=n.createShader(t);if(n.shaderSource(i,e),n.compileShader(i),!n.getShaderParameter(i,n.COMPILE_STATUS))throw new Error("compile error: "+n.getShaderInfoLog(i));return i}var r=this,n=this,a=this.createProgram();if(this.attachShader(a,i(this.VERTEX_SHADER,t)),this.attachShader(a,i(this.FRAGMENT_SHADER,e)),this.linkProgram(a),!this.getProgramParameter(a,this.LINK_STATUS))throw new Error("link error: "+this.getProgramInfoLog(a));return this.useProgram(a),a.setAttribLocations=function(t){for(var e=0,i=t.length;i>e;e+=1)a[t[e]]=r.getAttribLocation(a,t[e])},a.setUniformLocations=function(t){for(var e=0,i=t.length;i>e;e+=1)a[t[e]]=r.getUniformLocation(a,t[e])},a}function r(t){var e=this.createBuffer();return this.bindBuffer(this.ARRAY_BUFFER,e),this.bufferData(this.ARRAY_BUFFER,new Float32Array(t),this.STATIC_DRAW),this.bindBuffer(this.ARRAY_BUFFER,null),e}function n(t){var e=this.createBuffer();return this.bindBuffer(this.ELEMENT_ARRAY_BUFFER,e),this.bufferData(this.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),this.STATIC_DRAW),this.bindBuffer(this.ELEMENT_ARRAY_BUFFER,null),e}function a(t){return 0===(t&t-1)}function s(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];this.pixelStorei(this.UNPACK_FLIP_Y_WEBGL,!0);var i=this.createTexture();return this.bindTexture(this.TEXTURE_2D,i),this.texImage2D(this.TEXTURE_2D,0,this.RGBA,this.RGBA,this.UNSIGNED_BYTE,t),a(t.width)&&a(t.height)?(this.generateMipmap(this.TEXTURE_2D),e&&(this.texParameteri(this.TEXTURE_2D,this.TEXTURE_WRAP_S,this.REPEAT),this.texParameteri(this.TEXTURE_2D,this.TEXTURE_WRAP_T,this.REPEAT))):(this.texParameteri(this.TEXTURE_2D,this.TEXTURE_WRAP_S,this.CLAMP_TO_EDGE),this.texParameteri(this.TEXTURE_2D,this.TEXTURE_WRAP_T,this.CLAMP_TO_EDGE),this.texParameteri(this.TEXTURE_2D,this.TEXTURE_MIN_FILTER,this.LINEAR),this.texParameteri(this.TEXTURE_2D,this.TEXTURE_MAG_FILTER,this.LINEAR)),this.bindTexture(this.TEXTURE_2D,null),i}function o(t,e){var i=new Image;i.onload=function(){e&&e(i)},i.src=t}Object.defineProperty(e,"__esModule",{value:!0}),e.makeProgram=i,e.createArrayBufferWithData=r,e.createElementBufferWithData=n,e.isPowerOf2=a,e.createTextureWithData=s,e.createImageByURL=o},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();e.Matrix4=function(){function t(){i(this,t),this.identity=t.identity()}return r(t,null,[{key:"identity",value:function(){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},{key:"copy",value:function(e){var i=t.identity();return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}},{key:"perspective",value:function(e,i,r,n){var a=1/Math.tan(e/2),s=1/(r-n),o=t.identity();return o[0]=a/i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(n+r)*s,o[11]=-1,o[12]=0,o[13]=0,o[14]=2*n*r*s,o[15]=0,o}},{key:"orthogonal",value:function(e,i,r,n,a,s){var o=1/(e-i),h=1/(r-n),l=1/(a-s),u=t.identity();return u[0]=-2*o,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*h,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*l,u[11]=0,u[12]=(e+i)*o,u[13]=(n+r)*h,u[14]=(s+a)*l,u[15]=1,u}},{key:"scale",value:function(t,e){var i=e[0],r=e[1],n=e[2];t[0]*=i,t[1]*=i,t[2]*=i,t[3]*=i,t[4]*=r,t[5]*=r,t[6]*=r,t[7]*=r,t[8]*=n,t[9]*=n,t[10]*=n,t[11]*=n}},{key:"translate",value:function(t,e){var i=e[0],r=e[1],n=e[2];t[12]+=t[0]*i+t[4]*r+t[8]*n,t[13]+=t[1]*i+t[5]*r+t[9]*n,t[14]+=t[2]*i+t[6]*r+t[10]*n,t[15]+=t[3]*i+t[7]*r+t[11]*n}},{key:"inverse",value:function(e){var i=e[0],r=e[1],n=e[2],a=e[3],s=e[4],o=e[5],h=e[6],l=e[7],u=e[8],c=e[9],f=e[10],v=e[11],d=e[12],g=e[13],p=e[14],m=e[15],b=i*o-r*s,E=i*h-n*s,x=i*l-a*s,y=r*h-n*o,_=r*l-a*o,w=n*l-a*h,T=u*g-c*d,C=u*p-f*d,R=u*m-v*d,A=c*p-f*g,S=c*m-v*g,P=f*m-v*p,L=b*P-E*S+x*A+y*R-_*C+w*T;if(!L)return null;L=1/L;var M=t.identity();return M[0]=(o*P-h*S+l*A)*L,M[1]=(n*S-r*P-a*A)*L,M[2]=(g*w-p*_+m*y)*L,M[3]=(f*_-c*w-v*y)*L,M[4]=(h*R-s*P-l*C)*L,M[5]=(i*P-n*R+a*C)*L,M[6]=(p*x-d*w-m*E)*L,M[7]=(u*w-f*x+v*E)*L,M[8]=(s*S-o*R+l*T)*L,M[9]=(r*R-i*S-a*T)*L,M[10]=(d*_-g*x+m*b)*L,M[11]=(c*x-u*_-v*b)*L,M[12]=(o*C-s*A-h*T)*L,M[13]=(i*A-r*C+n*T)*L,M[14]=(g*E-d*y-p*b)*L,M[15]=(u*y-c*E+f*b)*L,M}},{key:"rotate",value:function(t,e,i,r){var n,a,s,o,h,l,u,c,f,v,d,g,p,m,b,E,x,y,_,w,T,C,R,A,S=r[0],P=r[1],L=r[2],M=Math.sqrt(S*S+P*P+L*L);return M=1/M,S*=M,P*=M,L*=M,n=Math.sin(i),a=Math.cos(i),s=1-a,o=e[0],h=e[1],l=e[2],u=e[3],c=e[4],f=e[5],v=e[6],d=e[7],g=e[8],p=e[9],m=e[10],b=e[11],E=S*S*s+a,x=P*S*s+L*n,y=L*S*s-P*n,_=S*P*s-L*n,w=P*P*s+a,T=L*P*s+S*n,C=S*L*s+P*n,R=P*L*s-S*n,A=L*L*s+a,t[0]=o*E+c*x+g*y,t[1]=h*E+f*x+p*y,t[2]=l*E+v*x+m*y,t[3]=u*E+d*x+b*y,t[4]=o*_+c*w+g*T,t[5]=h*_+f*w+p*T,t[6]=l*_+v*w+m*T,t[7]=u*_+d*w+b*T,t[8]=o*C+c*R+g*A,t[9]=h*C+f*R+p*A,t[10]=l*C+v*R+m*A,t[11]=u*C+d*R+b*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t}}]),t}()}]);